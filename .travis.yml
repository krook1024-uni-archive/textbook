branches:
  only:
  - master
language: xml
before_install:
- sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 0C49F3730359A14518585931BC711F9BA15703C6
- sudo apt-get update -q
install:
- sudo apt-get install xsltproc
- sudo apt-get install docbook
- sudo apt-get install docbook-xml docbook-xsl
- sudo apt-get install dblatex
- sudo apt-get install texlive-lang-european
- sudo apt-get install make
- sudo apt-get install pkg-config
- sudo apt-get install graphviz
- sudo apt-get install libxml2-utils
- sudo apt-get install imagemagick
script: make
before_deploy:
- git config --local user.name "krook1024"
- git config --local user.email "krook1024@gmail.com"
- export TRAVIS_TAG=${TRAVIS_TAG:-$(date +'%Y%m%d%H%M%S')-$(git log --format=%h -1)}
- git tag $TRAVIS_TAG
deploy:
  provider: releases
  api_key:
    secure: q+GjeQCoGgfFqDG60EDBOGxID7GEpKVqrnAzRuSezDwBEvS4+rYl26STl5iPHnIue+jT6gsgdxRokrCdMTDsn7vCC0kbNlSxEACoeyY9YOnX5vILJJOi5Q7WKhqG7w0REm1tg4lSEOJasnsYhry3Qy4tsX6QlaT9CQO8c4ZwyaDwx48RZVvtELJJpLFWdtCSg6slDhJQVQgkuEFXyeWtlj/cOy9zzK7Z+QQ68m/TNi0cvZh3+YSzFpV3TN2jXWSE9L6BvEuTfLATjUmnzs/AeDi6CPcsG0uuacHQD4lIycpqojxY3NQhFhWqJsBpsPbRvYqlX0mICOoRFvagtBGGEBwNjQ31vn5gQCtJ+/FmLmJiBG9twltVvNN8jSORJL1a2bYHuxTXUBDxsC+/RkCx/DS/s6TPo27xgcp7bUcQer53LbjJXNzhNbGflYXlqFAEBfkCqLrdIW+dQIg4ffH8rk6f3sESf5WQb0RfwM+/sdNKnu0rcvJwqqi8KEB0x/axMcVOGUz1/+xcIyDM3iEBzojIFVPeA4MC/rmOLi4kj7rGY7GB06J3uGUQkutWfnQ6DG4+04tLBm71+IzkUo39LNLtVHl658FOP1QHU7Bx68VRJqZVQdFx72Sj5Yh/fZrCP6mRrqotLYQph9cSZwF+vH71RCmOIIqJCFp7ojxdyR8=
  file: tb-fdl.pdf
  on:
    repo: krook1024/textbook
  skip_cleanup: true
  draft: true
